{"ast":null,"code":"var _jsxFileName = \"/home/haroon/Desktop/React/LearningReact/state_management/src/components/Checkout.jsx\";\nimport React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { saveShippingAddress } from \"../services/shippingService\";\nconst STATUS = {\n  IDLE: \"IDLE\",\n  SUBMITTED: \"SUBMITTED\",\n  SUBMITTING: \"SUBMITTING\",\n  COMPLETED: \"COMPLETED\"\n}; // Declaring outside component to avoid recreation on each render\n\nconst emptyAddress = {\n  city: \"\",\n  country: \"\"\n};\nexport default function Checkout({\n  cart,\n  emptyCart\n}) {\n  const [address, setAddress] = useState(emptyAddress);\n  const [status, setStatus] = useState(STATUS.IDLE);\n  const [saveError, setSaveError] = useState(null);\n  const [touched, setTouched] = useState({}); // Derived state\n\n  const errors = getErrors(address);\n  const isValid = Object.keys(errors).length === 0;\n\n  function handleChange(e) {\n    e.persist(); // persist the event\n\n    setAddress(curAddress => {\n      return { ...curAddress,\n        [e.target.id]: e.target.value\n      };\n    });\n  }\n\n  function handleBlur(event) {\n    event.persist();\n    setTouched(cur => {\n      return { ...cur,\n        [event.target.id]: true\n      };\n    });\n  }\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n    setStatus(STATUS.SUBMITTING);\n\n    if (isValid) {\n      try {\n        await saveShippingAddress(address);\n        emptyCart();\n        setStatus(STATUS.COMPLETED);\n      } catch (e) {\n        setSaveError(e);\n      }\n    } else {\n      setStatus(STATUS.SUBMITTED);\n    }\n  }\n\n  function getErrors(address) {\n    const result = {};\n    if (!address.city) result.city = \"City is required\";\n    if (!address.country) result.country = \"Country is required\";\n    return result;\n  }\n\n  if (saveError) throw saveError;\n\n  if (status === STATUS.COMPLETED) {\n    return /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 12\n      }\n    }, \"Thanks for shopping!\");\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, \"Shipping Info\"), !isValid && status === STATUS.SUBMITTED && /*#__PURE__*/React.createElement(\"div\", {\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }, \"Please fix the following errors:\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 11\n    }\n  }, Object.keys(errors).map(key => {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: key,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 22\n      }\n    }, errors[key]);\n  }))), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"city\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 11\n    }\n  }, \"City\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"city\",\n    type: \"text\",\n    value: address.city,\n    onBlur: handleBlur,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, (touched.city || status === STATUS.SUBMITTED) && errors.city)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"country\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, \"Country\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"select\", {\n    id: \"country\",\n    value: address.country,\n    onBlur: handleBlur,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }, \"Select Country\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"China\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, \"China\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"India\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }, \"India\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"United Kingdom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, \"United Kingdom\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"USA\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, \"USA\")), /*#__PURE__*/React.createElement(\"p\", {\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }, (touched.country || status === STATUS.SUBMITTED) && errors.country)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    value: \"Save Shipping Info\",\n    disabled: status === STATUS.SUBMITTING,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 11\n    }\n  }))));\n}","map":{"version":3,"sources":["/home/haroon/Desktop/React/LearningReact/state_management/src/components/Checkout.jsx"],"names":["React","useState","useNavigate","saveShippingAddress","STATUS","IDLE","SUBMITTED","SUBMITTING","COMPLETED","emptyAddress","city","country","Checkout","cart","emptyCart","address","setAddress","status","setStatus","saveError","setSaveError","touched","setTouched","errors","getErrors","isValid","Object","keys","length","handleChange","e","persist","curAddress","target","id","value","handleBlur","event","cur","handleSubmit","preventDefault","result","map","key"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { saveShippingAddress } from \"../services/shippingService\";\n\nconst STATUS = {\n  IDLE: \"IDLE\",\n  SUBMITTED: \"SUBMITTED\",\n  SUBMITTING: \"SUBMITTING\",\n  COMPLETED: \"COMPLETED\",\n};\n\n// Declaring outside component to avoid recreation on each render\nconst emptyAddress = {\n  city: \"\",\n  country: \"\",\n};\n\nexport default function Checkout({ cart, emptyCart }) {\n  const [address, setAddress] = useState(emptyAddress);\n  const [status, setStatus] = useState(STATUS.IDLE);\n  const [saveError, setSaveError] = useState(null);\n  const [touched, setTouched] = useState({});\n\n  // Derived state\n  const errors = getErrors(address);\n  const isValid = Object.keys(errors).length === 0;\n\n  function handleChange(e) {\n    e.persist(); // persist the event\n    setAddress((curAddress) => {\n      return {\n        ...curAddress,\n        [e.target.id]: e.target.value,\n      };\n    });\n  }\n\n  function handleBlur(event) {\n    event.persist();\n    setTouched((cur) => {\n      return { ...cur, [event.target.id]: true };\n    });\n  }\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n    setStatus(STATUS.SUBMITTING);\n    if (isValid) {\n      try {\n        await saveShippingAddress(address);\n        emptyCart();\n        setStatus(STATUS.COMPLETED);\n      } catch (e) {\n        setSaveError(e);\n      }\n    } else {\n      setStatus(STATUS.SUBMITTED);\n    }\n  }\n\n  function getErrors(address) {\n    const result = {};\n    if (!address.city) result.city = \"City is required\";\n    if (!address.country) result.country = \"Country is required\";\n    return result;\n  }\n\n  if (saveError) throw saveError;\n  if (status === STATUS.COMPLETED) {\n    return <h1>Thanks for shopping!</h1>;\n  }\n\n  return (\n    <>\n      <h1>Shipping Info</h1>\n      {!isValid && status === STATUS.SUBMITTED && (\n        <div role=\"alert\">\n          <p>Please fix the following errors:</p>\n          <ul>\n            {Object.keys(errors).map((key) => {\n              return <li key={key}>{errors[key]}</li>;\n            })}\n          </ul>\n        </div>\n      )}\n      <form onSubmit={handleSubmit}>\n        <div>\n          <label htmlFor=\"city\">City</label>\n          <br />\n          <input\n            id=\"city\"\n            type=\"text\"\n            value={address.city}\n            onBlur={handleBlur}\n            onChange={handleChange}\n          />\n          <p role=\"alert\">\n            {(touched.city || status === STATUS.SUBMITTED) && errors.city}\n          </p>\n        </div>\n\n        <div>\n          <label htmlFor=\"country\">Country</label>\n          <br />\n          <select\n            id=\"country\"\n            value={address.country}\n            onBlur={handleBlur}\n            onChange={handleChange}\n          >\n            <option value=\"\">Select Country</option>\n            <option value=\"China\">China</option>\n            <option value=\"India\">India</option>\n            <option value=\"United Kingdom\">United Kingdom</option>\n            <option value=\"USA\">USA</option>\n          </select>\n\n          <p role=\"alert\">\n            {(touched.country || status === STATUS.SUBMITTED) && errors.country}\n          </p>\n        </div>\n\n        <div>\n          <input\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            value=\"Save Shipping Info\"\n            disabled={status === STATUS.SUBMITTING}\n          />\n        </div>\n      </form>\n    </>\n  );\n}"]},"metadata":{},"sourceType":"module"}